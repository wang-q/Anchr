# Quality, Length and Coverage

[TOC levels=1-3]: # ""

- [Quality, Length and Coverage](#quality-length-and-coverage)
  - [qlx: reference](#qlx-reference)
  - [qlx: download](#qlx-download)
  - [qlx: QxxLxx](#qlx-qxxlxx)
  - [qlx: merge anchors with Qxx and QxxLxx](#qlx-merge-anchors-with-qxx-and-qxxlxx)
  - [qlx: QxxXxx](#qlx-qxxxxx)
  - [qlx: merge anchors with QxxXxx](#qlx-merge-anchors-with-qxxxxx)


## qlx: reference

* Reference genome

```shell script
mkdir -p ~/data/anchr/qlx/1_genome
cd ~/data/anchr/qlx/1_genome

cp ../../mg1655/1_genome/genome.fa .
cp ../../mg1655/1_genome/paralogs.fa .

```

## qlx: download

* Illumina

```shell script
mkdir -p ~/data/anchr/qlx/2_illumina
cd ~/data/anchr/qlx/2_illumina

cp ../../mg1655/2_illumina/MiSeq_Ecoli_MG1655_110721_PF_R1.fastq.gz R1.fq.gz
cp ../../mg1655/2_illumina/MiSeq_Ecoli_MG1655_110721_PF_R2.fastq.gz R2.fq.gz

```

## qlx: QxxLxx

* template

```shell script
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=qlx

cd ${WORKING_DIR}/${BASE_NAME}

rm *.sh
anchr template \
    --genome 4641652 \
    --parallel 24 \
    --xmx 80g \
    \
    --trim "--dedupe --tile" \
    --qual "20 25 30 35" \
    --len "60 90" \
    --filter "adapter artifact" \
    \
    --quorum \
    --cov "40 80" \
    --statp 2

```

* run

```shell script
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=qlx

cd ${WORKING_DIR}/${BASE_NAME}

bash 2_trim.sh
bash 9_stat_reads.sh

bash 2_quorum.sh

bash 4_down_sampling.sh;
bash 4_unitigs.sh;
bash 4_anchors.sh;
bash 9_stat_anchors.sh 4_unitigs statUnitigsAnchors.md

#bsub -q mpi -n 24 -J "${BASE_NAME}-0_master" "bash 0_master.sh"

```

Table: statReads

| Name       |     N50 |     Sum |        # |
|:-----------|--------:|--------:|---------:|
| Genome     | 4641652 | 4641652 |        1 |
| Paralogs   |    1937 |  187300 |      106 |
| Illumina.R |     151 |   1.73G | 11458940 |
| trim.R     |     149 |   1.43G | 10384824 |
| Q20L60     |     149 |   1.41G | 10241081 |
| Q20L90     |     150 |   1.37G |  9758468 |
| Q25L60     |     148 |   1.32G |  9952094 |
| Q25L90     |     149 |   1.26G |  9178896 |
| Q30L60     |     128 |   1.11G |  9321006 |
| Q30L90     |     131 | 992.67M |  7824899 |
| Q35L60     |      72 | 358.31M |  4940590 |
| Q35L90     |      95 |  34.46M |   355919 |


Table: statTrimReads

| Name           | N50 |     Sum |        # |
|:---------------|----:|--------:|---------:|
| clumpify       | 151 |   1.73G | 11439000 |
| filteredbytile | 151 |   1.67G | 11067578 |
| trim           | 149 |   1.43G | 10385332 |
| filter         | 149 |   1.43G | 10384824 |
| R1             | 150 | 737.14M |  5192412 |
| R2             | 144 | 691.53M |  5192412 |
| Rs             |   0 |       0 |        0 |


```text
#R.trim
#Matched	18909	0.17085%
#Name	Reads	ReadsPct
```

```text
#R.filter
#Matched	507	0.00488%
#Name	Reads	ReadsPct
```

Table: statQuorum

| Name     | CovIn | CovOut | Discard% | Kmer | RealG |  EstG | Est/Real |   RunTime |
|:---------|------:|-------:|---------:|-----:|------:|------:|---------:|----------:|
| Q0L0.R   | 307.8 |  285.8 |    7.13% | "95" | 4.64M | 4.66M |     1.00 | 0:02'36'' |
| Q20L60.R | 303.3 |  283.9 |    6.41% | "95" | 4.64M | 4.63M |     1.00 | 0:02'34'' |
| Q20L90.R | 295.5 |  276.5 |    6.42% | "95" | 4.64M | 4.61M |     0.99 | 0:02'29'' |
| Q25L60.R | 284.3 |  273.2 |    3.89% | "87" | 4.64M | 4.57M |     0.98 | 0:02'28'' |
| Q25L90.R | 271.8 |  261.0 |    3.95% | "91" | 4.64M | 4.57M |     0.98 | 0:02'23'' |
| Q30L60.R | 238.5 |  233.6 |    2.07% | "73" | 4.64M | 4.56M |     0.98 | 0:02'09'' |
| Q30L90.R | 214.1 |  209.6 |    2.14% | "79" | 4.64M | 4.56M |     0.98 | 0:01'59'' |
| Q35L60.R |  77.6 |   76.8 |    1.09% | "45" | 4.64M |  4.5M |     0.97 | 0:01'00'' |
| Q35L90.R |   7.5 |    7.0 |    7.13% | "65" | 4.64M | 1.98M |     0.43 | 0:00'13'' |


Table: statUnitigsAnchors.md

| Name          | CovCor | Mapped% | N50Anchor |   Sum |    # | N50Others |     Sum |    # | median | MAD | lower | upper |                Kmer | RunTimeUT | RunTimeAN |
|:--------------|-------:|--------:|----------:|------:|-----:|----------:|--------:|-----:|-------:|----:|------:|------:|--------------------:|----------:|----------:|
| Q0L0X40P000   |   40.0 |  96.22% |      7315 | 4.32M |  816 |       769 |  190.8K | 1848 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:50 |   0:00:37 |
| Q0L0X40P001   |   40.0 |  96.02% |      8593 | 4.43M |  752 |       250 | 119.64K | 1762 |   39.0 | 3.0 |  10.0 |  72.0 | "31,41,51,61,71,81" |   0:00:44 |   0:00:38 |
| Q0L0X40P002   |   40.0 |  96.04% |      7383 | 4.35M |  841 |       686 | 199.41K | 1883 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:45 |   0:00:35 |
| Q0L0X80P000   |   80.0 |  92.01% |      4676 | 4.27M | 1185 |        90 | 153.69K | 2474 |   79.0 | 6.0 |  20.3 | 145.5 | "31,41,51,61,71,81" |   0:01:12 |   0:00:34 |
| Q0L0X80P001   |   80.0 |  92.05% |      4859 | 4.27M | 1171 |        72 | 137.48K | 2436 |   79.0 | 6.0 |  20.3 | 145.5 | "31,41,51,61,71,81" |   0:01:12 |   0:00:35 |
| Q0L0X80P002   |   80.0 |  91.93% |      4631 | 4.26M | 1184 |        83 |  144.6K | 2454 |   79.0 | 6.0 |  20.3 | 145.5 | "31,41,51,61,71,81" |   0:01:11 |   0:00:34 |
| Q20L60X40P000 |   40.0 |  96.51% |      7226 | 4.31M |  821 |       703 | 194.33K | 1802 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:43 |   0:00:34 |
| Q20L60X40P001 |   40.0 |  96.17% |      7929 | 4.33M |  812 |       582 | 184.13K | 1756 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:43 |   0:00:34 |
| Q20L60X40P002 |   40.0 |  96.58% |      7445 |  4.3M |  791 |       652 | 195.74K | 1745 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:44 |   0:00:35 |
| Q20L60X80P000 |   80.0 |  92.76% |      5245 |  4.3M | 1094 |        85 |  135.5K | 2269 |   79.0 | 6.0 |  20.3 | 145.5 | "31,41,51,61,71,81" |   0:01:11 |   0:00:34 |
| Q20L60X80P001 |   80.0 |  93.26% |      5356 | 4.31M | 1076 |        93 | 139.81K | 2252 |   79.0 | 6.0 |  20.3 | 145.5 | "31,41,51,61,71,81" |   0:01:12 |   0:00:34 |
| Q20L60X80P002 |   80.0 |  93.30% |      5318 | 4.32M | 1074 |        88 | 135.28K | 2272 |   79.0 | 6.0 |  20.3 | 145.5 | "31,41,51,61,71,81" |   0:01:11 |   0:00:35 |
| Q20L90X40P000 |   40.0 |  96.74% |      7620 | 4.22M |  783 |       663 | 215.19K | 1606 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:44 |   0:00:35 |
| Q20L90X40P001 |   40.0 |  96.89% |      7700 | 4.24M |  804 |       688 | 221.12K | 1645 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:44 |   0:00:34 |
| Q20L90X40P002 |   40.0 |  96.69% |      9537 | 4.41M |  683 |       291 | 126.59K | 1585 |   39.0 | 3.0 |  10.0 |  72.0 | "31,41,51,61,71,81" |   0:00:44 |   0:00:34 |
| Q20L90X80P000 |   80.0 |  93.88% |      6179 | 4.32M | 1019 |        87 | 151.18K | 2147 |   79.0 | 6.0 |  20.3 | 145.5 | "31,41,51,61,71,81" |   0:01:13 |   0:00:36 |
| Q20L90X80P001 |   80.0 |  93.93% |      5922 | 4.32M | 1001 |        96 |  152.6K | 2120 |   79.0 | 6.0 |  20.3 | 145.5 | "31,41,51,61,71,81" |   0:01:13 |   0:00:36 |
| Q20L90X80P002 |   80.0 |  93.76% |      5614 | 4.31M | 1019 |        84 |  147.9K | 2151 |   79.0 | 6.0 |  20.3 | 145.5 | "31,41,51,61,71,81" |   0:01:12 |   0:00:35 |
| Q25L60X40P000 |   40.0 |  97.82% |      9970 | 4.12M |  636 |       752 | 197.76K | 1567 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:44 |   0:00:38 |
| Q25L60X40P001 |   40.0 |  97.73% |      9895 | 4.18M |  639 |       812 | 217.95K | 1559 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:43 |   0:00:38 |
| Q25L60X40P002 |   40.0 |  97.66% |      9698 | 4.16M |  644 |       787 | 195.35K | 1554 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:43 |   0:00:36 |
| Q25L60X80P000 |   80.0 |  96.61% |      9536 | 4.43M |  720 |       256 | 117.09K | 1647 |   79.0 | 5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:10 |   0:00:37 |
| Q25L60X80P001 |   80.0 |  96.50% |      9169 | 4.43M |  715 |       310 | 114.24K | 1609 |   79.0 | 5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:11 |   0:00:37 |
| Q25L60X80P002 |   80.0 |  96.65% |      9637 | 4.44M |  703 |       116 | 106.11K | 1617 |   79.0 | 5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:11 |   0:00:37 |
| Q25L90X40P000 |   40.0 |  97.88% |      9489 | 3.92M |  638 |       835 | 205.99K | 1353 |   40.0 | 2.0 |  11.3 |  69.0 | "31,41,51,61,71,81" |   0:00:44 |   0:00:37 |
| Q25L90X40P001 |   40.0 |  97.96% |     11174 | 4.35M |  574 |       753 |  172.1K | 1428 |   40.0 | 3.0 |  10.3 |  73.5 | "31,41,51,61,71,81" |   0:00:44 |   0:00:39 |
| Q25L90X40P002 |   40.0 |  97.67% |     12019 | 4.37M |  571 |       500 | 135.59K | 1349 |   40.0 | 3.0 |  10.3 |  73.5 | "31,41,51,61,71,81" |   0:00:44 |   0:00:39 |
| Q25L90X80P000 |   80.0 |  96.94% |      9401 | 4.38M |  697 |       571 | 155.86K | 1504 |   79.0 | 5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:11 |   0:00:38 |
| Q25L90X80P001 |   80.0 |  96.85% |      9899 | 4.37M |  672 |       305 | 132.76K | 1483 |   79.0 | 5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:12 |   0:00:38 |
| Q25L90X80P002 |   80.0 |  96.83% |      9658 | 4.35M |  690 |       562 |  154.1K | 1510 |   79.0 | 5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:12 |   0:00:37 |
| Q30L60X40P000 |   40.0 |  98.58% |      9940 | 3.59M |  578 |       927 | 286.99K | 1492 |   40.0 | 2.0 |  11.3 |  69.0 | "31,41,51,61,71,81" |   0:00:42 |   0:00:43 |
| Q30L60X40P001 |   40.0 |  98.51% |     14482 | 4.26M |  478 |       878 | 181.45K | 1552 |   40.0 | 3.0 |  10.3 |  73.5 | "31,41,51,61,71,81" |   0:00:43 |   0:00:42 |
| Q30L60X40P002 |   40.0 |  98.50% |     13445 | 3.97M |  479 |       919 | 190.27K | 1508 |   40.0 | 3.0 |  10.3 |  73.5 | "31,41,51,61,71,81" |   0:00:42 |   0:00:41 |
| Q30L60X80P000 |   80.0 |  98.50% |     13206 | 4.04M |  483 |       820 | 192.81K | 1360 |   79.0 | 4.0 |  22.3 | 136.5 | "31,41,51,61,71,81" |   0:01:07 |   0:00:47 |
| Q30L60X80P001 |   80.0 |  98.47% |     15553 | 4.32M |  445 |       912 | 155.45K | 1343 |   79.0 | 5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:08 |   0:00:46 |
| Q30L90X40P000 |   40.0 |  98.40% |      8773 | 3.19M |  572 |      1027 | 281.57K | 1214 |   40.0 | 3.0 |  10.3 |  73.5 | "31,41,51,61,71,81" |   0:00:44 |   0:00:39 |
| Q30L90X40P001 |   40.0 |  98.40% |      8874 | 3.21M |  556 |      1026 | 287.52K | 1275 |   40.0 | 3.0 |  10.3 |  73.5 | "31,41,51,61,71,81" |   0:00:44 |   0:00:39 |
| Q30L90X40P002 |   40.0 |  98.42% |      8905 | 3.23M |  565 |      1021 |  276.3K | 1309 |   39.0 | 3.0 |  10.0 |  72.0 | "31,41,51,61,71,81" |   0:00:44 |   0:00:40 |
| Q30L90X80P000 |   80.0 |  98.36% |      9887 |  3.2M |  506 |      1017 | 235.87K | 1081 |   79.0 | 5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:09 |   0:00:42 |
| Q30L90X80P001 |   80.0 |  98.41% |      9683 | 3.19M |  512 |      1002 | 223.49K | 1054 |   79.0 | 5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:11 |   0:00:43 |
| Q35L60X40P000 |   40.0 |  85.59% |      1444 | 1.25M |  854 |      1925 |   2.67M | 2467 |   40.0 | 8.0 |   5.3 |  80.0 | "31,41,51,61,71,81" |   0:00:29 |   0:00:29 |


## qlx: merge anchors with Qxx and QxxLxx

```shell script
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=qlx

cd ${HOME}/data/anchr/${BASE_NAME}

READ_QUAL="20 25 30 35"
READ_LEN="60 90"
COVERAGE2="40 80"

# merge anchors with Qxx
for Q in 0 ${READ_QUAL}; do
    echo "==> Q${Q}"
    bash 7_merge_anchors.sh 4_unitigs/Q${Q} 7_merge_unitigs_Q${Q}
done

# quast
rm -fr 9_quast_merge_unitigs_Qxx
quast --no-check --threads 16 \
    -R 1_genome/genome.fa \
    $( parallel -k 'printf "7_merge_unitigs_Q{1}/anchor.merge.fasta "' ::: ${READ_QUAL} ) \
    1_genome/paralogs.fa \
    --label "$( parallel -k 'printf "mergeQ{1},"' ::: ${READ_QUAL} )paralogs" \
    -o 9_quast_merge_unitigs_Qxx

# merge anchors with QxxLxx
echo "==> Q0L0"
bash 7_merge_anchors.sh 4_unitigs/Q0L0 7_merge_unitigs_Q0L0
for Q in ${READ_QUAL}; do
    for L in ${READ_LEN}; do
        echo "==> Q${Q}L${L}"
        bash 7_merge_anchors.sh 4_unitigs/Q${Q}L${L} 7_merge_unitigs_Q${Q}L${L}
    done
done

# quast
rm -fr 9_quast_merge_unitigs_QxxLxx
quast --no-check --threads 16 \
    -R 1_genome/genome.fa \
    7_merge_unitigs_Q0L0/anchor.merge.fasta \
    $( parallel -k 'printf "7_merge_unitigs_Q{1}L{2}/anchor.merge.fasta "' ::: ${READ_QUAL} ::: ${READ_LEN} ) \
    1_genome/paralogs.fa \
    --label "Q0L0,$( parallel -k 'printf "mergeQ{1}L{2},"' ::: ${READ_QUAL} ::: ${READ_LEN} )paralogs" \
    -o 9_quast_merge_unitigs_QxxLxx

```

## qlx: QxxXxx

* template

```shell script
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=qlx

cd ${WORKING_DIR}/${BASE_NAME}

rm *.sh
anchr template \
    --genome 4641652 \
    --parallel 24 \
    --xmx 80g \
    \
    --trim "--dedupe --tile" \
    --qual "25 30" \
    --len "60" \
    --filter "adapter artifact" \
    \
    --quorum \
    --merge \
    --ecphase "1 3" \
    --cov "20 30 40 50 60 80 120 160 200" \
    --statp 2

```

* run

```shell script
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=qlx

cd ${WORKING_DIR}/${BASE_NAME}

bash 4_down_sampling.sh;
bash 4_unitigs.sh;
bash 4_anchors.sh;
bash 9_stat_anchors.sh 4_unitigs statUnitigsAnchors.md

bash 2_merge.sh

bash 6_down_sampling.sh
bash 6_unitigs.sh
bash 6_anchors.sh
bash 9_statMRAnchors.sh 6_unitigs statMRUnitigsAnchors.md

#bsub -q mpi -n 24 -J "${BASE_NAME}-0_master" "bash 0_master.sh"

```

Table: statUnitigsAnchors.md

| Name           | CovCor | Mapped% | N50Anchor |   Sum |    # | N50Others |     Sum |    # | median |  MAD | lower | upper |                Kmer | RunTimeUT | RunTimeAN |
|:---------------|-------:|--------:|----------:|------:|-----:|----------:|--------:|-----:|-------:|-----:|------:|------:|--------------------:|----------:|----------:|
| Q0L0X20P000    |   20.0 |  97.71% |      6728 | 3.89M |  840 |       841 | 446.22K | 2191 |   20.0 |  1.0 |   5.7 |  34.5 | "31,41,51,61,71,81" |   0:00:46 |   0:00:39 |
| Q0L0X20P001    |   20.0 |  97.78% |      6711 |  3.8M |  828 |       918 | 464.76K | 2167 |   20.0 |  1.0 |   5.7 |  34.5 | "31,41,51,61,71,81" |   0:00:32 |   0:00:39 |
| Q0L0X20P002    |   20.0 |  97.85% |      6752 | 3.77M |  812 |       882 | 405.15K | 2036 |   20.0 |  1.0 |   5.7 |  34.5 | "31,41,51,61,71,81" |   0:00:31 |   0:00:39 |
| Q0L0X30P000    |   30.0 |  97.07% |      8987 | 4.39M |  697 |       599 | 181.52K | 1773 |   29.0 |  2.0 |   7.7 |  52.5 | "31,41,51,61,71,81" |   0:00:38 |   0:00:37 |
| Q0L0X30P001    |   30.0 |  97.03% |      9257 | 4.35M |  694 |       652 | 177.96K | 1765 |   29.0 |  2.0 |   7.7 |  52.5 | "31,41,51,61,71,81" |   0:00:38 |   0:00:37 |
| Q0L0X30P002    |   30.0 |  96.93% |      8932 |  4.4M |  749 |       585 | 180.39K | 1822 |   29.0 |  2.0 |   7.7 |  52.5 | "31,41,51,61,71,81" |   0:00:37 |   0:00:37 |
| Q0L0X40P000    |   40.0 |  96.22% |      7315 | 4.32M |  816 |       769 |  190.8K | 1848 |   39.0 |  2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:50 |   0:00:37 |
| Q0L0X40P001    |   40.0 |  96.02% |      8593 | 4.43M |  752 |       250 | 119.64K | 1762 |   39.0 |  3.0 |  10.0 |  72.0 | "31,41,51,61,71,81" |   0:00:44 |   0:00:38 |
| Q0L0X40P002    |   40.0 |  96.04% |      7383 | 4.35M |  841 |       686 | 199.41K | 1883 |   39.0 |  2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:45 |   0:00:35 |
| Q0L0X50P000    |   50.0 |  95.18% |      6855 | 4.35M |  880 |       365 | 149.35K | 1950 |   49.0 |  3.0 |  13.3 |  87.0 | "31,41,51,61,71,81" |   0:00:51 |   0:00:34 |
| Q0L0X50P001    |   50.0 |  95.09% |      7012 | 4.37M |  899 |       332 | 155.21K | 1953 |   49.0 |  3.0 |  13.3 |  87.0 | "31,41,51,61,71,81" |   0:00:51 |   0:00:35 |
| Q0L0X50P002    |   50.0 |  95.42% |      7164 | 4.35M |  859 |       223 | 142.39K | 1931 |   49.0 |  3.0 |  13.3 |  87.0 | "31,41,51,61,71,81" |   0:00:51 |   0:00:37 |
| Q0L0X60P000    |   60.0 |  94.16% |      6226 | 4.33M |  974 |       331 | 149.25K | 2099 |   59.0 |  4.0 |  15.7 | 106.5 | "31,41,51,61,71,81" |   0:00:58 |   0:00:37 |
| Q0L0X60P001    |   60.0 |  93.94% |      6077 | 4.35M | 1022 |        75 | 126.53K | 2175 |   59.0 |  4.0 |  15.7 | 106.5 | "31,41,51,61,71,81" |   0:00:58 |   0:00:35 |
| Q0L0X60P002    |   60.0 |  94.18% |      5685 | 4.35M | 1023 |        98 | 141.21K | 2176 |   59.0 |  4.0 |  15.7 | 106.5 | "31,41,51,61,71,81" |   0:00:57 |   0:00:38 |
| Q0L0X80P000    |   80.0 |  92.01% |      4676 | 4.27M | 1185 |        90 | 153.69K | 2474 |   79.0 |  6.0 |  20.3 | 145.5 | "31,41,51,61,71,81" |   0:01:12 |   0:00:34 |
| Q0L0X80P001    |   80.0 |  92.05% |      4859 | 4.27M | 1171 |        72 | 137.48K | 2436 |   79.0 |  6.0 |  20.3 | 145.5 | "31,41,51,61,71,81" |   0:01:12 |   0:00:35 |
| Q0L0X80P002    |   80.0 |  91.93% |      4631 | 4.26M | 1184 |        83 |  144.6K | 2454 |   79.0 |  6.0 |  20.3 | 145.5 | "31,41,51,61,71,81" |   0:01:11 |   0:00:34 |
| Q0L0X120P000   |  120.0 |  87.98% |      3519 | 4.08M | 1411 |        79 | 169.03K | 2921 |  118.0 |  9.0 |  30.3 | 217.5 | "31,41,51,61,71,81" |   0:01:41 |   0:00:37 |
| Q0L0X120P001   |  120.0 |  88.15% |      3440 | 4.08M | 1444 |        77 | 170.42K | 2974 |  119.0 |  9.0 |  30.7 | 219.0 | "31,41,51,61,71,81" |   0:01:39 |   0:00:38 |
| Q0L0X160P000   |  160.0 |  84.67% |      2973 | 3.91M | 1527 |        91 | 188.51K | 3142 |  158.0 | 12.0 |  40.7 | 291.0 | "31,41,51,61,71,81" |   0:02:10 |   0:00:38 |
| Q0L0X200P000   |  200.0 |  82.07% |      2673 | 3.78M | 1583 |       474 | 201.77K | 3270 |  198.0 | 16.0 |  50.0 | 369.0 | "31,41,51,61,71,81" |   0:02:37 |   0:00:40 |
| Q25L60X20P000  |   20.0 |  98.32% |      5949 | 3.15M |  765 |       902 | 444.28K | 1938 |   20.0 |  1.0 |   5.7 |  34.5 | "31,41,51,61,71,81" |   0:00:31 |   0:00:41 |
| Q25L60X20P001  |   20.0 |  98.27% |      5801 | 3.14M |  753 |      1033 | 513.99K | 1841 |   20.0 |  1.0 |   5.7 |  34.5 | "31,41,51,61,71,81" |   0:00:30 |   0:00:40 |
| Q25L60X20P002  |   20.0 |  98.24% |      6125 | 3.06M |  710 |       931 | 426.53K | 1798 |   20.0 |  1.0 |   5.7 |  34.5 | "31,41,51,61,71,81" |   0:00:31 |   0:00:41 |
| Q25L60X30P000  |   30.0 |  98.19% |     12023 | 4.37M |  563 |       457 | 157.18K | 1681 |   30.0 |  2.0 |   8.0 |  54.0 | "31,41,51,61,71,81" |   0:00:37 |   0:00:40 |
| Q25L60X30P001  |   30.0 |  98.14% |     12725 | 4.34M |  531 |       640 | 171.36K | 1631 |   30.0 |  2.0 |   8.0 |  54.0 | "31,41,51,61,71,81" |   0:00:37 |   0:00:42 |
| Q25L60X30P002  |   30.0 |  98.16% |     12337 | 4.31M |  549 |       593 | 160.02K | 1626 |   30.0 |  2.0 |   8.0 |  54.0 | "31,41,51,61,71,81" |   0:00:38 |   0:00:41 |
| Q25L60X40P000  |   40.0 |  97.82% |      9970 | 4.12M |  636 |       752 | 197.76K | 1567 |   39.0 |  2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:44 |   0:00:38 |
| Q25L60X40P001  |   40.0 |  97.73% |      9895 | 4.18M |  639 |       812 | 217.95K | 1559 |   39.0 |  2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:43 |   0:00:38 |
| Q25L60X40P002  |   40.0 |  97.66% |      9698 | 4.16M |  644 |       787 | 195.35K | 1554 |   39.0 |  2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:43 |   0:00:36 |
| Q25L60X50P000  |   50.0 |  97.45% |     10534 | 4.39M |  630 |       622 | 152.07K | 1552 |   49.0 |  3.0 |  13.3 |  87.0 | "31,41,51,61,71,81" |   0:00:51 |   0:00:40 |
| Q25L60X50P001  |   50.0 |  97.41% |     11937 | 4.43M |  606 |       629 | 145.76K | 1486 |   49.0 |  3.0 |  13.3 |  87.0 | "31,41,51,61,71,81" |   0:00:53 |   0:00:39 |
| Q25L60X50P002  |   50.0 |  97.32% |     10367 | 4.35M |  619 |       753 | 147.83K | 1483 |   49.0 |  3.0 |  13.3 |  87.0 | "31,41,51,61,71,81" |   0:00:52 |   0:00:38 |
| Q25L60X60P000  |   60.0 |  97.16% |     10917 | 4.45M |  623 |       395 | 120.99K | 1541 |   59.0 |  4.0 |  15.7 | 106.5 | "31,41,51,61,71,81" |   0:00:58 |   0:00:39 |
| Q25L60X60P001  |   60.0 |  97.10% |     10887 | 4.45M |  629 |       349 | 111.53K | 1489 |   59.0 |  4.0 |  15.7 | 106.5 | "31,41,51,61,71,81" |   0:00:58 |   0:00:41 |
| Q25L60X60P002  |   60.0 |  97.15% |     10374 | 4.46M |  627 |       249 | 102.91K | 1467 |   59.0 |  4.0 |  15.7 | 106.5 | "31,41,51,61,71,81" |   0:00:59 |   0:00:39 |
| Q25L60X80P000  |   80.0 |  96.61% |      9536 | 4.43M |  720 |       256 | 117.09K | 1647 |   79.0 |  5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:10 |   0:00:37 |
| Q25L60X80P001  |   80.0 |  96.50% |      9169 | 4.43M |  715 |       310 | 114.24K | 1609 |   79.0 |  5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:11 |   0:00:37 |
| Q25L60X80P002  |   80.0 |  96.65% |      9637 | 4.44M |  703 |       116 | 106.11K | 1617 |   79.0 |  5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:11 |   0:00:37 |
| Q25L60X120P000 |  120.0 |  95.71% |      7701 | 4.41M |  834 |        87 | 105.26K | 1805 |  119.0 |  8.0 |  31.7 | 214.5 | "31,41,51,61,71,81" |   0:01:41 |   0:00:40 |
| Q25L60X120P001 |  120.0 |  95.73% |      7789 | 4.42M |  817 |        84 | 100.93K | 1781 |  119.0 |  8.0 |  31.7 | 214.5 | "31,41,51,61,71,81" |   0:01:39 |   0:00:41 |
| Q25L60X160P000 |  160.0 |  95.14% |      7154 |  4.4M |  905 |        74 |  98.24K | 1903 |  159.0 | 12.0 |  41.0 | 292.5 | "31,41,51,61,71,81" |   0:02:06 |   0:00:41 |
| Q25L60X200P000 |  200.0 |  94.81% |      6601 | 4.38M |  941 |        70 | 102.46K | 1982 |  199.0 | 14.0 |  52.3 | 361.5 | "31,41,51,61,71,81" |   0:02:33 |   0:00:45 |
| Q30L60X20P000  |   20.0 |  98.24% |     10825 | 4.09M |  589 |       853 | 228.74K | 1800 |   20.0 |  2.0 |   4.7 |  39.0 | "31,41,51,61,71,81" |   0:00:30 |   0:00:42 |
| Q30L60X20P001  |   20.0 |  98.34% |     11298 | 4.19M |  600 |       663 | 218.68K | 1997 |   20.0 |  2.0 |   4.7 |  39.0 | "31,41,51,61,71,81" |   0:00:30 |   0:00:41 |
| Q30L60X20P002  |   20.0 |  98.30% |     11044 | 4.21M |  591 |       946 | 214.17K | 1869 |   20.0 |  2.0 |   4.7 |  39.0 | "31,41,51,61,71,81" |   0:00:30 |   0:00:40 |
| Q30L60X30P000  |   30.0 |  98.53% |     10883 | 3.93M |  563 |       834 | 249.17K | 1633 |   30.0 |  2.0 |   8.0 |  54.0 | "31,41,51,61,71,81" |   0:00:38 |   0:00:42 |
| Q30L60X30P001  |   30.0 |  98.46% |     11196 | 3.86M |  549 |      1022 | 264.52K | 1622 |   30.0 |  2.0 |   8.0 |  54.0 | "31,41,51,61,71,81" |   0:00:37 |   0:00:42 |
| Q30L60X30P002  |   30.0 |  98.45% |     10957 | 3.64M |  523 |       890 | 274.05K | 1621 |   30.0 |  2.0 |   8.0 |  54.0 | "31,41,51,61,71,81" |   0:00:36 |   0:00:41 |
| Q30L60X40P000  |   40.0 |  98.58% |      9940 | 3.59M |  578 |       927 | 286.99K | 1492 |   40.0 |  2.0 |  11.3 |  69.0 | "31,41,51,61,71,81" |   0:00:42 |   0:00:43 |
| Q30L60X40P001  |   40.0 |  98.51% |     14482 | 4.26M |  478 |       878 | 181.45K | 1552 |   40.0 |  3.0 |  10.3 |  73.5 | "31,41,51,61,71,81" |   0:00:43 |   0:00:42 |
| Q30L60X40P002  |   40.0 |  98.50% |     13445 | 3.97M |  479 |       919 | 190.27K | 1508 |   40.0 |  3.0 |  10.3 |  73.5 | "31,41,51,61,71,81" |   0:00:42 |   0:00:41 |
| Q30L60X50P000  |   50.0 |  98.56% |     13448 | 3.94M |  483 |       755 | 186.09K | 1411 |   49.0 |  3.0 |  13.3 |  87.0 | "31,41,51,61,71,81" |   0:00:49 |   0:00:46 |
| Q30L60X50P001  |   50.0 |  98.50% |     13888 | 3.94M |  479 |       911 | 200.97K | 1454 |   50.0 |  3.0 |  13.7 |  88.5 | "31,41,51,61,71,81" |   0:00:48 |   0:00:46 |
| Q30L60X50P002  |   50.0 |  98.56% |     13696 | 3.97M |  484 |       894 | 203.67K | 1478 |   49.0 |  3.0 |  13.3 |  87.0 | "31,41,51,61,71,81" |   0:00:50 |   0:00:46 |
| Q30L60X60P000  |   60.0 |  98.51% |     12474 | 3.78M |  501 |       879 | 201.43K | 1369 |   59.0 |  3.0 |  16.7 | 102.0 | "31,41,51,61,71,81" |   0:00:54 |   0:00:46 |
| Q30L60X60P001  |   60.0 |  98.52% |     16270 | 4.28M |  421 |       861 |  153.4K | 1409 |   60.0 |  4.0 |  16.0 | 108.0 | "31,41,51,61,71,81" |   0:00:56 |   0:00:46 |
| Q30L60X60P002  |   60.0 |  98.56% |     17206 | 4.31M |  415 |       854 | 162.51K | 1399 |   60.0 |  4.0 |  16.0 | 108.0 | "31,41,51,61,71,81" |   0:00:59 |   0:00:48 |
| Q30L60X80P000  |   80.0 |  98.50% |     13206 | 4.04M |  483 |       820 | 192.81K | 1360 |   79.0 |  4.0 |  22.3 | 136.5 | "31,41,51,61,71,81" |   0:01:07 |   0:00:47 |
| Q30L60X80P001  |   80.0 |  98.47% |     15553 | 4.32M |  445 |       912 | 155.45K | 1343 |   79.0 |  5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:08 |   0:00:46 |
| Q30L60X120P000 |  120.0 |  98.41% |     15240 | 4.25M |  458 |       764 | 156.56K | 1316 |  119.0 |  6.0 |  33.7 | 205.5 | "31,41,51,61,71,81" |   0:01:34 |   0:00:51 |
| Q30L60X160P000 |  160.0 |  98.37% |     15538 | 4.33M |  435 |       685 | 118.45K | 1265 |  159.0 |  9.0 |  44.0 | 279.0 | "31,41,51,61,71,81" |   0:02:01 |   0:00:52 |
| Q30L60X200P000 |  200.0 |  98.32% |     16748 | 4.38M |  433 |       649 | 114.21K | 1229 |  198.0 | 11.0 |  55.0 | 346.5 | "31,41,51,61,71,81" |   0:02:24 |   0:00:56 |

Table: statMergeReads

| Name          | N50 |    Sum |        # |
|:--------------|----:|-------:|---------:|
| clumped       | 149 |  1.43G | 10383638 |
| ecco          | 149 |  1.43G | 10383638 |
| ecct          | 149 |  1.42G | 10317762 |
| extended      | 189 |  1.83G | 10317762 |
| merged.raw    | 339 |  1.72G |  5081860 |
| unmerged.raw  | 173 | 22.42M |   154042 |
| unmerged.trim | 173 | 22.41M |   153956 |
| M1            | 339 |  1.71G |  5054424 |
| U1            | 179 | 11.73M |    76978 |
| U2            | 167 | 10.68M |    76978 |
| Us            |   0 |      0 |        0 |
| M.cor         | 338 |  1.73G | 10262804 |

| Group              |  Mean | Median | STDev | PercentOfPairs |
|:-------------------|------:|-------:|------:|---------------:|
| M.ihist.merge1.txt | 271.7 |    277 |  23.6 |         10.82% |
| M.ihist.merge.txt  | 337.7 |    338 |  19.3 |         98.51% |

Table: statMRUnitigsAnchors.md

| Name       | CovCor | Mapped% | N50Anchor |   Sum |   # | N50Others |     Sum |    # | median |  MAD | lower | upper |                Kmer | RunTimeUT | RunTimeAN |
|:-----------|-------:|--------:|----------:|------:|----:|----------:|--------:|-----:|-------:|-----:|------:|------:|--------------------:|----------:|----------:|
| MRX20P000  |   20.0 |  96.63% |     12836 | 2.66M | 337 |       654 |   92.2K |  479 |   19.0 |  1.0 |   5.3 |  33.0 | "31,41,51,61,71,81" |   0:00:36 |   0:00:33 |
| MRX20P001  |   20.0 |  96.72% |     15292 |  3.5M | 357 |       542 |   97.3K |  522 |   20.0 |  1.0 |   5.7 |  34.5 | "31,41,51,61,71,81" |   0:00:36 |   0:00:34 |
| MRX20P002  |   20.0 |  96.65% |     15177 | 3.28M | 358 |       782 |  97.09K |  501 |   20.0 |  1.0 |   5.7 |  34.5 | "31,41,51,61,71,81" |   0:00:35 |   0:00:34 |
| MRX30P000  |   30.0 |  96.25% |     13300 | 3.65M | 429 |       259 |    109K |  643 |   29.0 |  1.0 |   8.7 |  48.0 | "31,41,51,61,71,81" |   0:00:45 |   0:00:35 |
| MRX30P001  |   30.0 |  96.24% |     14032 | 3.61M | 422 |       402 | 118.33K |  657 |   29.0 |  1.0 |   8.7 |  48.0 | "31,41,51,61,71,81" |   0:00:46 |   0:00:32 |
| MRX30P002  |   30.0 |  96.27% |     13316 | 3.65M | 420 |       297 | 109.83K |  638 |   29.0 |  1.0 |   8.7 |  48.0 | "31,41,51,61,71,81" |   0:00:46 |   0:00:34 |
| MRX40P000  |   40.0 |  95.77% |     18871 | 4.42M | 403 |       127 |  90.95K |  782 |   39.0 |  2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:56 |   0:00:33 |
| MRX40P001  |   40.0 |  95.70% |     19037 | 4.38M | 374 |       141 |  95.59K |  735 |   39.0 |  2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:55 |   0:00:35 |
| MRX40P002  |   40.0 |  95.67% |     18253 | 4.45M | 399 |       136 |  99.67K |  796 |   39.0 |  2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" |   0:00:55 |   0:00:33 |
| MRX50P000  |   50.0 |  95.24% |     18687 | 4.45M | 402 |       123 |  92.62K |  830 |   49.0 |  3.0 |  13.3 |  87.0 | "31,41,51,61,71,81" |   0:01:03 |   0:00:35 |
| MRX50P001  |   50.0 |  95.22% |     17603 | 4.45M | 402 |       124 |  95.55K |  838 |   49.0 |  3.0 |  13.3 |  87.0 | "31,41,51,61,71,81" |   0:01:05 |   0:00:35 |
| MRX50P002  |   50.0 |  95.22% |     15261 | 4.39M | 457 |       140 | 120.58K |  913 |   49.0 |  2.0 |  14.3 |  82.5 | "31,41,51,61,71,81" |   0:01:05 |   0:00:34 |
| MRX60P000  |   60.0 |  94.94% |     15274 | 4.43M | 439 |       128 | 109.38K |  913 |   59.0 |  3.0 |  16.7 | 102.0 | "31,41,51,61,71,81" |   0:01:14 |   0:00:36 |
| MRX60P001  |   60.0 |  94.82% |     15731 | 4.43M | 462 |       127 | 109.78K |  948 |   59.0 |  3.0 |  16.7 | 102.0 | "31,41,51,61,71,81" |   0:01:13 |   0:00:35 |
| MRX60P002  |   60.0 |  94.97% |     14541 | 4.44M | 470 |       126 |  113.2K |  962 |   59.0 |  3.0 |  16.7 | 102.0 | "31,41,51,61,71,81" |   0:01:14 |   0:00:35 |
| MRX80P000  |   80.0 |  94.18% |     13410 | 4.41M | 525 |       123 | 122.14K | 1092 |   79.0 |  5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:32 |   0:00:38 |
| MRX80P001  |   80.0 |  94.20% |     12651 | 4.42M | 535 |       124 | 123.93K | 1117 |   79.0 |  5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:33 |   0:00:37 |
| MRX80P002  |   80.0 |  94.45% |     13233 | 4.43M | 517 |       123 | 117.05K | 1076 |   79.0 |  5.0 |  21.3 | 141.0 | "31,41,51,61,71,81" |   0:01:33 |   0:00:36 |
| MRX120P000 |  120.0 |  93.02% |     10404 | 4.37M | 635 |       124 |  148.9K | 1320 |  118.0 |  8.0 |  31.3 | 213.0 | "31,41,51,61,71,81" |   0:02:10 |   0:00:38 |
| MRX120P001 |  120.0 |  93.40% |     10652 | 4.38M | 638 |       124 | 151.63K | 1326 |  118.0 |  8.0 |  31.3 | 213.0 | "31,41,51,61,71,81" |   0:02:11 |   0:00:38 |
| MRX120P002 |  120.0 |  93.22% |     10668 | 4.38M | 636 |       123 | 143.51K | 1318 |  118.0 |  8.0 |  31.3 | 213.0 | "31,41,51,61,71,81" |   0:02:11 |   0:00:40 |
| MRX160P000 |  160.0 |  92.42% |      9102 | 4.35M | 698 |       124 | 162.84K | 1448 |  157.0 | 11.0 |  41.3 | 285.0 | "31,41,51,61,71,81" |   0:02:52 |   0:00:39 |
| MRX160P001 |  160.0 |  92.58% |      9097 | 4.36M | 713 |       121 | 159.76K | 1469 |  157.0 | 11.0 |  41.3 | 285.0 | "31,41,51,61,71,81" |   0:02:49 |   0:00:40 |
| MRX200P000 |  200.0 |  91.95% |      8063 | 4.33M | 753 |       123 | 175.63K | 1563 |  197.0 | 15.0 |  50.7 | 363.0 | "31,41,51,61,71,81" |   0:03:26 |   0:00:42 |


## qlx: merge anchors with QxxXxx

```shell script
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=qlx

cd ${HOME}/data/anchr/${BASE_NAME}

READ_QUAL="25 30"
READ_LEN="60"
COVERAGE2="20 30 40 50 60 80 120 160 200"

# merge anchors with QxxXxx
for Q in ${READ_QUAL}; do
    for X in ${COVERAGE2}; do
        echo "==> Q${Q}X${L}"
        bash 7_merge_anchors.sh 4_unitigs/Q${Q}L${READ_LEN}X${X} 7_merge_unitigs_Q${Q}X${X}
    done
done
for X in ${COVERAGE2}; do
    echo "==> Q0X${X}"
    bash 7_merge_anchors.sh 4_unitigs/Q0L0X${X} 7_merge_unitigs_Q0X${X}
done

# quast
rm -fr 9_qa_merge_QxxXxx
quast --no-check --threads 16 \
    -R 1_genome/genome.fa \
    $( parallel -k 'printf "7_merge_unitigs_Q{1}X{2}/anchor.merge.fasta "' ::: 0 ${READ_QUAL} ::: ${COVERAGE2} ) \
    1_genome/paralogs.fa \
    --label "$( parallel -k 'printf "mergeQ{1}X{2},"' ::: 0 ${READ_QUAL} ::: ${COVERAGE2} )paralogs" \
    -o 9_qa_merge_QxxXxx

```

